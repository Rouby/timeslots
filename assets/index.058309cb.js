var j=Object.defineProperty,I=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var b=(i,e,t)=>e in i?j(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,f=(i,e)=>{for(var t in e||(e={}))S.call(e,t)&&b(i,t,e[t]);if(C)for(var t of C(e))P.call(e,t)&&b(i,t,e[t]);return i},h=(i,e)=>I(i,L(e));import{j as v,u as A,r as k,Q as E,a as R,b as $}from"./vendor.d20aa874.js";const F=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}};F();const Q="modulepreload",D={},W="/timeslots/",q=function(e,t){return!t||t.length===0?e():Promise.all(t.map(n=>{if(n=`${W}${n}`,n in D)return;D[n]=!0;const r=n.endsWith(".css"),o=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${o}`))return;const s=document.createElement("link");if(s.rel=r?"stylesheet":Q,r||(s.as="script",s.crossOrigin=""),s.href=n,document.head.appendChild(s),r)return new Promise((a,y)=>{s.addEventListener("load",a),s.addEventListener("error",y)})})).then(()=>e())},l=v.exports.jsx,p=v.exports.jsxs,g=v.exports.Fragment;function B({date:i}){var t,n;const e=new Intl.DateTimeFormat([],{weekday:"short"});return isNaN(i.getTime())?l(g,{children:"N/A"}):l(g,{children:(n=(t=e.formatToParts(i).find(r=>r.type==="weekday"))==null?void 0:t.value)!=null?n:"N/A"})}function O({startDate:i,endDate:e}){const t=new Intl.DateTimeFormat([],{hour:"numeric",minute:"numeric"});return isNaN(i.getTime())||isNaN(e.getTime())?l(g,{children:"N/A"}):l(g,{children:t.formatRange(i,e)})}function K(){return A("time_slots",async()=>(await(await fetch("/time_slots")).json()).map(t=>h(f({},t),{time_slots_by_day:t.time_slots.map(n=>h(f({},n),{start_time:new Date(n.start_time),end_time:new Date(n.end_time)})).reduce((n,r)=>{const o=r.start_time.getDay();return n[o]||(n[o]=[]),n[o].push(r),n[o].sort((s,a)=>s.start_time.getTime()-a.start_time.getTime()),n},{})})))}function V(){var r,o;const{isLoading:i,data:e}=K(),[t,n]=k.exports.useState({});return p("div",{style:{display:"grid",gridTemplateColumns:`repeat(${(r=e==null?void 0:e.length)!=null?r:1}, 1fr)`,gridTemplateRows:"auto 1fr",height:"100vh"},children:[i?l("div",{children:"Loading slots..."}):null,e==null?void 0:e.map(({id:s,name:a})=>p("div",{children:[l("h2",{children:a}),p("div",{"data-testid":"reservation","data-company":s,children:["Reservation:"," ",t[s]?l(O,{startDate:t[s].start_time,endDate:t[s].end_time}):"None"]})]},s)),l("div",{style:{overflow:"auto",gridColumn:"span 3",display:"grid",gridTemplateColumns:`repeat(${(o=e==null?void 0:e.length)!=null?o:1}, 1fr)`},children:e==null?void 0:e.map(({id:s,time_slots_by_day:a})=>l(k.exports.Fragment,{children:l("div",{"data-testid":"timeslots","data-company":s,children:Object.entries(a).map(([y,T])=>p("div",{children:[l("h3",{style:{textAlign:"center"},children:l(B,{date:T[0].start_time})}),l("div",{style:{display:"flex",flexDirection:"column"},children:T.map(({start_time:c,end_time:d})=>{var N;const[_,u]=(N=Object.entries(t).find(([,m])=>m&&(c>=m.start_time&&c<m.end_time||d>m.start_time&&d<=m.end_time)))!=null?N:[null,null],x=_===`${s}`,w=(u==null?void 0:u.start_time.getTime())===c.getTime()&&(u==null?void 0:u.end_time.getTime())===d.getTime();return l("button",{onClick:()=>{n(h(f({},t),{[s]:w?null:{start_time:c,end_time:d}}))},disabled:_?!x:!1,style:{display:"block",borderColor:x&&w?"red":void 0,padding:5,margin:5},"data-testid":"timeslot",children:l(O,{startDate:c,endDate:d})},c.toISOString()+d.toISOString())})})]},y))})},s))})]})}const z=new E;function G(){return l(R,{client:z,children:l(V,{})})}q(()=>import("./browser.9a6cd7e1.js"),["assets/browser.9a6cd7e1.js","assets/vendor.d20aa874.js"]).then(({worker:i})=>i.start({serviceWorker:{url:"/timeslots/mockServiceWorker.js"}}));$.exports.render(l(G,{}),document.getElementById("root"));
